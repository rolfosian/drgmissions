## **Make sure to extract drgmissionsgod.json.7z if you want to run the server or mission finder

## **Deep Rock Galactic lua scripts for use with [RE-UE4SS lua API](https://github.com/UE4SS-RE/RE-UE4SS/) to fetch current mission and deep dive data for flask**

- To run DRG headless, use command line arg `-nullrhi` when running the game.
- Tested working with a Windows 10 virtual machine using `-nullrhi` (Requires OpenGL or dx11 for the UE4SS GUI if you want to use it).
- Make sure to [skip intro videos](https://www.pcgamingwiki.com/wiki/Deep_Rock_Galactic#Skip_intro_videos) and also use `-nosplash` command line arg if desired.
- Be sure to disable Steam cloud save synchronization.
- Unzip UE4SS into steamapps\common\Deep Rock Galactic\FSD\Binaries\Win64 - this is also the CWD of the scripts run by the UE4SS hook.

* [This lua script will collect all of the missions generated by DRG up until the date set by the target_date variable](./mods/BulkMissionsScraper/Scripts/main.lua). Its corresponding python script for automated `mods.txt` and easy user input for setting the target date is [BulkMissions_Run.py](./BulkMissions_Run.py). This python script goes in `Deep Rock Galactic\FSD\Binaries\Win64\`. The python interpreter is required to be run with administrator privileges with this script.
- `Deep Rock Galactic\FSD.exe` **AND** `Deep Rock Galactic\FSD\Binaries\Win64\FSD-Win64-Shipping.exe` **AND ALSO** `Steam.exe` **ARE ALL** required to be run with administrator privileges in order for this script to be able to modify the system clock and run without errors!

- [This lua script](./mods/DailyDealsScraper/Scripts/main.lua) and its [corresponding python script](./DailyDeals_Run.py) will fetch 365 days worth of daily deals. Adjust the total_days variable in the lua script if you want more or less.

- If running the clock changing scripts in a VM, make sure to turn off guest/host timesync, IE: https://www.virtualbox.org/manual/ch09.html#disabletimesync `VBoxManage setextradata VM-name "VBoxInternal/Devices/VMMDev/0/Config/GetHostTimeDisabled" 1`

- The `.*_Run.py` python scripts will handle toggling the system automatic time sync settings on and off. Run the scripts using `Scrapers_Run.cmd`

- [This lua script will fetch the current Deep Dive data and exit the game in short order](./mods/DeepDivesScraper/Scripts/main.lua)

## **Virtual Machine Setup**
1. Pick a VM Software (Virtualbox, VMWare, Qemu, etc) and install a Windows 10 machine. Give it at least 4 cores or it will run very poorly, and 4-8GB of ram.
2. Pick your poison of which version of Windows, I recommend LTSC 21H2, it's more forgiving on disabling updates and stuff and is just generally more lightweight than the other distros.
3. Make sure to turn off guest/host timesync if your chosen vm software has it; IE: https://www.virtualbox.org/manual/ch09.html#disabletimesync `VBoxManage setextradata VM-name "VBoxInternal/Devices/VMMDev/0/Config/GetHostTimeDisabled" 1` **This is critical**
4. Make sure Steam auto logon is enabled, install Deep Rock Galactic, and set the launch options `-nullrhi` and `-nosplash` as well as [skip intro videos](https://www.pcgamingwiki.com/wiki/Deep_Rock_Galactic#Skip_intro_videos)
5. Install the [mesa-dist-win msvc release](https://github.com/pal1000/mesa-dist-win/releases/) for enabling OpenGL on Qemu etc. Or, if running Virtualbox, you don't need this, you can just install the Virtualbox Guest Additions with 3d acceleration enabled and change [this](https://github.com/UE4SS-RE/RE-UE4SS/blob/main/assets/UE4SS-settings.ini#L98) to dx11. *only needed if you want to run the ue4ss console gui
6. Copy the `cfg.json`, the `.*_Run.py` scripts, the `drgmissions_scraper_utils.py` library, and `drgmissions_validator.py` script to the `Deep Rock Galactic\FSD\Binaries\Win64` folder
7. Finally unzip [UE4SS](https://github.com/UE4SS-RE/RE-UE4SS/releases/download/v3.0.1/UE4SS_v3.0.1.zip) into the `steamapps\common\Deep Rock Galactic\FSD\Binaries\Win64` and merge the [mods](./mods) folders.
8. Run the desired scrapers via [Scrapers_Run.cmd](./Scrapers_Run.cmd)

## **TODO**
- **Public Enemy Number One**: Check and Update Deep Dive scraper weekly to accomodate currently unknown configurations (havent seen any unknowns in months), **contingencies for if Steam misbehaves**
- Fix canvas mission icon jaggies in js
- Move static site to github pages, set up github actions for deployment of metadata and edit `.*_Run` scripts accordingly

- Figure out how to manipulate wine(?) system clock with hook on linux

-------------------------------------------------------------------------------------------
***This is a third-party project and it is not affiliated, endorsed, or sponsored by Ghost Ship Games. The use of Deep Rock Galactic's in-game assets in this project is solely for illustrative purposes and does not imply any ownership or association with the game or its developers. All copyrights and trademarks belong to their respective owners. For official information about Deep Rock Galactic, please visit the official Ghost Ship Games website.***